<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>GRINS-0.8.0: GRINS::RayfireMesh Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">GRINS-0.8.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceGRINS.html">GRINS</a></li><li class="navelem"><a class="el" href="classGRINS_1_1RayfireMesh.html">RayfireMesh</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="classGRINS_1_1RayfireMesh-members.html">List of all members</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">GRINS::RayfireMesh Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classGRINS_1_1RayfireMesh.html" title="RayfireMesh. ">RayfireMesh</a>.  
 <a href="classGRINS_1_1RayfireMesh.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="rayfire__mesh_8h_source.html">rayfire_mesh.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac8c89b3310465638ed043a38ded08191"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#ac8c89b3310465638ed043a38ded08191">RayfireMesh</a> (libMesh::Point &amp;origin, libMesh::Real theta)</td></tr>
<tr class="memdesc:ac8c89b3310465638ed043a38ded08191"><td class="mdescLeft">&#160;</td><td class="mdescRight">2D Constructor  <a href="#ac8c89b3310465638ed043a38ded08191">More...</a><br /></td></tr>
<tr class="separator:ac8c89b3310465638ed043a38ded08191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e813ee40abf0b3c7317d9b394a9b304"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a3e813ee40abf0b3c7317d9b394a9b304">RayfireMesh</a> (libMesh::Point &amp;origin, libMesh::Real theta, libMesh::Real phi)</td></tr>
<tr class="memdesc:a3e813ee40abf0b3c7317d9b394a9b304"><td class="mdescLeft">&#160;</td><td class="mdescRight">3D Constructor  <a href="#a3e813ee40abf0b3c7317d9b394a9b304">More...</a><br /></td></tr>
<tr class="separator:a3e813ee40abf0b3c7317d9b394a9b304"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e0b8744a5173e0f615cbe6363075b6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a98e0b8744a5173e0f615cbe6363075b6">RayfireMesh</a> (const GetPot &amp;input, const std::string &amp;qoi_string)</td></tr>
<tr class="memdesc:a98e0b8744a5173e0f615cbe6363075b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input File Constructor.  <a href="#a98e0b8744a5173e0f615cbe6363075b6">More...</a><br /></td></tr>
<tr class="separator:a98e0b8744a5173e0f615cbe6363075b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e77e4d3278ed740d1f9f9e19ce91e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#aa0e77e4d3278ed740d1f9f9e19ce91e9">RayfireMesh</a> (const <a class="el" href="classGRINS_1_1RayfireMesh.html">RayfireMesh</a> &amp;original)</td></tr>
<tr class="memdesc:aa0e77e4d3278ed740d1f9f9e19ce91e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy Constructor.  <a href="#aa0e77e4d3278ed740d1f9f9e19ce91e9">More...</a><br /></td></tr>
<tr class="separator:aa0e77e4d3278ed740d1f9f9e19ce91e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1db884a1ec3202addc1cfa27ba11933"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#ad1db884a1ec3202addc1cfa27ba11933">init</a> (const libMesh::MeshBase &amp;mesh_base)</td></tr>
<tr class="memdesc:ad1db884a1ec3202addc1cfa27ba11933"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization.  <a href="#ad1db884a1ec3202addc1cfa27ba11933">More...</a><br /></td></tr>
<tr class="separator:ad1db884a1ec3202addc1cfa27ba11933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66248d3ab42b1fbcd354433303c92b9a"><td class="memItemLeft" align="right" valign="top">const libMesh::Elem *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a66248d3ab42b1fbcd354433303c92b9a">map_to_rayfire_elem</a> (const libMesh::dof_id_type elem_id)</td></tr>
<tr class="memdesc:a66248d3ab42b1fbcd354433303c92b9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes in an elem_id on the main mesh and returns an elem from the 1D rayfire mesh.  <a href="#a66248d3ab42b1fbcd354433303c92b9a">More...</a><br /></td></tr>
<tr class="separator:a66248d3ab42b1fbcd354433303c92b9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac461ae6a5878263663f72c879ae99f36"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#ac461ae6a5878263663f72c879ae99f36">elem_ids_in_rayfire</a> (std::vector&lt; libMesh::dof_id_type &gt; &amp;id_vector) const </td></tr>
<tr class="memdesc:ac461ae6a5878263663f72c879ae99f36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a vector of elem IDs that are currently along the rayfire.  <a href="#ac461ae6a5878263663f72c879ae99f36">More...</a><br /></td></tr>
<tr class="separator:ac461ae6a5878263663f72c879ae99f36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92b40395eb3d9f854eaf0871ccc056a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#aa92b40395eb3d9f854eaf0871ccc056a">reinit</a> (const libMesh::MeshBase &amp;mesh_base)</td></tr>
<tr class="memdesc:aa92b40395eb3d9f854eaf0871ccc056a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks for refined and coarsened main mesh elements along the rayfire path.  <a href="#aa92b40395eb3d9f854eaf0871ccc056a">More...</a><br /></td></tr>
<tr class="separator:aa92b40395eb3d9f854eaf0871ccc056a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a3468c4e01f951bfaa7078b3317bb7787"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a3468c4e01f951bfaa7078b3317bb7787">RayfireMesh</a> ()</td></tr>
<tr class="memdesc:a3468c4e01f951bfaa7078b3317bb7787"><td class="mdescLeft">&#160;</td><td class="mdescRight">User should never call the default constructor.  <a href="#a3468c4e01f951bfaa7078b3317bb7787">More...</a><br /></td></tr>
<tr class="separator:a3468c4e01f951bfaa7078b3317bb7787"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23d9e910b017b4e86d80f681df3c515f"><td class="memItemLeft" align="right" valign="top">libMesh::Elem *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a23d9e910b017b4e86d80f681df3c515f">get_rayfire_elem</a> (const libMesh::dof_id_type elem_id)</td></tr>
<tr class="memdesc:a23d9e910b017b4e86d80f681df3c515f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Private function to get a rayfire elem from main_mesh elem ID.  <a href="#a23d9e910b017b4e86d80f681df3c515f">More...</a><br /></td></tr>
<tr class="separator:a23d9e910b017b4e86d80f681df3c515f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e41959f10c48e69fa51348da8bda055"><td class="memItemLeft" align="right" valign="top">const libMesh::Elem *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a0e41959f10c48e69fa51348da8bda055">get_next_elem</a> (const libMesh::Elem *cur_elem, libMesh::Point &amp;start_point, libMesh::Point &amp;end_point, bool same_parent=false)</td></tr>
<tr class="memdesc:a0e41959f10c48e69fa51348da8bda055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the intersection point.  <a href="#a0e41959f10c48e69fa51348da8bda055">More...</a><br /></td></tr>
<tr class="separator:a0e41959f10c48e69fa51348da8bda055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a498f0a29729d7a3b81e87af0beb1e6cb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a498f0a29729d7a3b81e87af0beb1e6cb">check_valid_point</a> (libMesh::Point &amp;intersection_point, libMesh::Point &amp;start_point, const libMesh::Elem &amp;edge_elem, libMesh::Point &amp;next_point)</td></tr>
<tr class="memdesc:a498f0a29729d7a3b81e87af0beb1e6cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure the calculated intersection point is on the edge_elem and is not the start_point.  <a href="#a498f0a29729d7a3b81e87af0beb1e6cb">More...</a><br /></td></tr>
<tr class="separator:a498f0a29729d7a3b81e87af0beb1e6cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2f8b0ec9569200fd1e8cb5806a4d3f1"><td class="memItemLeft" align="right" valign="top">const libMesh::Elem *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#ad2f8b0ec9569200fd1e8cb5806a4d3f1">get_correct_neighbor</a> (libMesh::Point &amp;start_point, libMesh::Point &amp;end_point, const libMesh::Elem *cur_elem, unsigned int side, bool same_parent)</td></tr>
<tr class="memdesc:ad2f8b0ec9569200fd1e8cb5806a4d3f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Knowing the end_point, get the appropraite next elem along the path.  <a href="#ad2f8b0ec9569200fd1e8cb5806a4d3f1">More...</a><br /></td></tr>
<tr class="separator:ad2f8b0ec9569200fd1e8cb5806a4d3f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa5770c975074c01d2c20962fdd6e074"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#aaa5770c975074c01d2c20962fdd6e074">check_origin_on_boundary</a> (const libMesh::Elem *start_elem)</td></tr>
<tr class="memdesc:aaa5770c975074c01d2c20962fdd6e074"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure the supplied origin is on a boundary of the mesh.  <a href="#aaa5770c975074c01d2c20962fdd6e074">More...</a><br /></td></tr>
<tr class="separator:aaa5770c975074c01d2c20962fdd6e074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0e858574528656b3ecac0b15148e4b6"><td class="memItemLeft" align="right" valign="top">const libMesh::Elem *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#af0e858574528656b3ecac0b15148e4b6">get_start_elem</a> (const libMesh::MeshBase &amp;mesh_base)</td></tr>
<tr class="memdesc:af0e858574528656b3ecac0b15148e4b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the correct starting elem corresponding to _origin.  <a href="#af0e858574528656b3ecac0b15148e4b6">More...</a><br /></td></tr>
<tr class="separator:af0e858574528656b3ecac0b15148e4b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66e1db520895502349af00fa70391ac3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a66e1db520895502349af00fa70391ac3">validate_edge</a> (const libMesh::Point &amp;start_point, const libMesh::Point &amp;end_point, const libMesh::Elem *side_elem, const libMesh::Elem *neighbor)</td></tr>
<tr class="memdesc:a66e1db520895502349af00fa70391ac3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensures the rayfire doesn't wander into the middle of an elem.  <a href="#a66e1db520895502349af00fa70391ac3">More...</a><br /></td></tr>
<tr class="separator:a66e1db520895502349af00fa70391ac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69149972a2c2b212da4dfea87254c935"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">rayfire_in_elem</a> (const libMesh::Point &amp;end_point, const libMesh::Elem *elem)</td></tr>
<tr class="memdesc:a69149972a2c2b212da4dfea87254c935"><td class="mdescLeft">&#160;</td><td class="mdescRight">Walks a short distance along the rayfire and checks if elem contains that point.  <a href="#a69149972a2c2b212da4dfea87254c935">More...</a><br /></td></tr>
<tr class="separator:a69149972a2c2b212da4dfea87254c935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75c657ad438157c9d522c9feeac1eb25"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a75c657ad438157c9d522c9feeac1eb25">newton_solve_intersection</a> (libMesh::Point &amp;initial_point, const libMesh::Elem *edge_elem, libMesh::Point &amp;intersection_point)</td></tr>
<tr class="memdesc:a75c657ad438157c9d522c9feeac1eb25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterative solver for calculating the intersection point of the rayfire on the side of an elem.  <a href="#a75c657ad438157c9d522c9feeac1eb25">More...</a><br /></td></tr>
<tr class="separator:a75c657ad438157c9d522c9feeac1eb25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38be0fb7a492ad0005ef4fabc52baaa6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a38be0fb7a492ad0005ef4fabc52baaa6">refine</a> (const libMesh::Elem *main_elem, libMesh::Elem *rayfire_elem)</td></tr>
<tr class="memdesc:a38be0fb7a492ad0005ef4fabc52baaa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refinement of a rayfire element whose main mesh counterpart was refined.  <a href="#a38be0fb7a492ad0005ef4fabc52baaa6">More...</a><br /></td></tr>
<tr class="separator:a38be0fb7a492ad0005ef4fabc52baaa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91d1c21e91df24fa119934047ca7e58b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a91d1c21e91df24fa119934047ca7e58b">coarsen</a> (const libMesh::Elem *rayfire_elem)</td></tr>
<tr class="memdesc:a91d1c21e91df24fa119934047ca7e58b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coarsening of a rayfire element whose main mesh counterpart was coarsened.  <a href="#a91d1c21e91df24fa119934047ca7e58b">More...</a><br /></td></tr>
<tr class="separator:a91d1c21e91df24fa119934047ca7e58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a21ac01d53d82a291dbd0d9219a4435fe"><td class="memItemLeft" align="right" valign="top">const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">_dim</a></td></tr>
<tr class="memdesc:a21ac01d53d82a291dbd0d9219a4435fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of the main mesh.  <a href="#a21ac01d53d82a291dbd0d9219a4435fe">More...</a><br /></td></tr>
<tr class="separator:a21ac01d53d82a291dbd0d9219a4435fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8d4f4fceea9148cd24697418455ca2d"><td class="memItemLeft" align="right" valign="top">libMesh::Point&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a></td></tr>
<tr class="memdesc:ab8d4f4fceea9148cd24697418455ca2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Origin point.  <a href="#ab8d4f4fceea9148cd24697418455ca2d">More...</a><br /></td></tr>
<tr class="separator:ab8d4f4fceea9148cd24697418455ca2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3496824565e791d09a9b5e583e6634a9"><td class="memItemLeft" align="right" valign="top">libMesh::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a></td></tr>
<tr class="memdesc:a3496824565e791d09a9b5e583e6634a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rayfire Spherical polar angle (in radians)  <a href="#a3496824565e791d09a9b5e583e6634a9">More...</a><br /></td></tr>
<tr class="separator:a3496824565e791d09a9b5e583e6634a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55348114d2a7c62c74ba9d9d8ee5e289"><td class="memItemLeft" align="right" valign="top">libMesh::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a55348114d2a7c62c74ba9d9d8ee5e289">_phi</a></td></tr>
<tr class="memdesc:a55348114d2a7c62c74ba9d9d8ee5e289"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rayfire Spherical azimuthal angle (in radians)  <a href="#a55348114d2a7c62c74ba9d9d8ee5e289">More...</a><br /></td></tr>
<tr class="separator:a55348114d2a7c62c74ba9d9d8ee5e289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c3dd53b7aeb5fc90accac7cc2f4a5f"><td class="memItemLeft" align="right" valign="top">libMesh::UniquePtr&lt; libMesh::Mesh &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a></td></tr>
<tr class="memdesc:af2c3dd53b7aeb5fc90accac7cc2f4a5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal 1D mesh of EDGE2 elements.  <a href="#af2c3dd53b7aeb5fc90accac7cc2f4a5f">More...</a><br /></td></tr>
<tr class="separator:af2c3dd53b7aeb5fc90accac7cc2f4a5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4444026efd745db379c306522eb1abae"><td class="memItemLeft" align="right" valign="top">std::map&lt; libMesh::dof_id_type, libMesh::dof_id_type &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a></td></tr>
<tr class="memdesc:a4444026efd745db379c306522eb1abae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map of main mesh elem_id to rayfire mesh elem_id.  <a href="#a4444026efd745db379c306522eb1abae">More...</a><br /></td></tr>
<tr class="separator:a4444026efd745db379c306522eb1abae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classGRINS_1_1RayfireMesh.html" title="RayfireMesh. ">RayfireMesh</a>. </p>
<p>This class performs a rayfire across a given mesh. The user supplies an origin point on the mesh boundary, and spherical angle(s) theta (and phi for 3D) to describe the direction of the rayfire. As is standard in spherical coordinates, theta is the angle from the x-axis in the xy-plane, with counterclockwise being positive. -2&pi; &le; theta &le; +2&pi;. Phi is the angle from the xy-plane, with phi&gt;0 being in the positive half of the z-plane. -&pi; &le; phi &le; +&pi;</p>
<p>Starting at the given origin point, this class will walk in a straight line across the mesh in the prescribed direction. On each element along the line, the class will calculate the point where it enters and leaves that element. Knowing the entering and exiting points, an EDGE2 element is created with those points as nodes, and is added to an internal 1D mesh. This repeats until a main mesh boundary is reached.</p>
<p>The intent of this class is to use the 1D mesh to integrate quantities along the rayfire path. Using the <a class="el" href="classGRINS_1_1RayfireMesh.html#a66248d3ab42b1fbcd354433303c92b9a" title="This function takes in an elem_id on the main mesh and returns an elem from the 1D rayfire mesh...">map_to_rayfire_elem()</a> function, a separate integration class can access the 1D elements, prescribe a desired quadrature rule, and perform integration directly along the line, rather than using the entire 2D/3D elements of the main mesh.</p>
<p>Refinement and coarsening of the rayfire mesh are supported through the <a class="el" href="classGRINS_1_1RayfireMesh.html#aa92b40395eb3d9f854eaf0871ccc056a" title="Checks for refined and coarsened main mesh elements along the rayfire path. ">reinit()</a> function. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8h_source.html#l00065">65</a> of file <a class="el" href="rayfire__mesh_8h_source.html">rayfire_mesh.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac8c89b3310465638ed043a38ded08191"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GRINS::RayfireMesh::RayfireMesh </td>
          <td>(</td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Real&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>2D Constructor </p>
<p>This is restricted to 2D meshes. The <a class="el" href="classGRINS_1_1RayfireMesh.html#ad1db884a1ec3202addc1cfa27ba11933" title="Initialization. ">init()</a> function must be called to perform the actual rayfire. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">origin</td><td>Origin point (x,y) of the rayfire on mesh boundary </td></tr>
    <tr><td class="paramname">theta</td><td>Spherical polar angle (in radians) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00051">51</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00142">_theta</a>, and <a class="el" href="math__constants_8h_source.html#l00036">GRINS::Constants::pi</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                                                  :</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">_dim</a>(2),</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>(origin),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a>(theta),</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a55348114d2a7c62c74ba9d9d8ee5e289">_phi</a>(-7.0) <span class="comment">// bounds on angles are +/- 2pi</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a>) &gt; 2.0*<a class="code" href="namespaceGRINS_1_1Constants.html#a597bccbbe42021c9b682558e2a94e2f7">Constants::pi</a>)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;Please supply a theta value between -2*pi and 2*pi&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div>
<div class="ttc" id="namespaceGRINS_1_1Constants_html_a597bccbbe42021c9b682558e2a94e2f7"><div class="ttname"><a href="namespaceGRINS_1_1Constants.html#a597bccbbe42021c9b682558e2a94e2f7">GRINS::Constants::pi</a></div><div class="ttdeci">const libMesh::Real pi</div><div class="ttdef"><b>Definition:</b> <a href="math__constants_8h_source.html#l00036">math_constants.h:36</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ab8d4f4fceea9148cd24697418455ca2d"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">GRINS::RayfireMesh::_origin</a></div><div class="ttdeci">libMesh::Point _origin</div><div class="ttdoc">Origin point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00139">rayfire_mesh.h:139</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a21ac01d53d82a291dbd0d9219a4435fe"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">GRINS::RayfireMesh::_dim</a></div><div class="ttdeci">const unsigned int _dim</div><div class="ttdoc">Dimension of the main mesh. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00136">rayfire_mesh.h:136</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a55348114d2a7c62c74ba9d9d8ee5e289"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a55348114d2a7c62c74ba9d9d8ee5e289">GRINS::RayfireMesh::_phi</a></div><div class="ttdeci">libMesh::Real _phi</div><div class="ttdoc">Rayfire Spherical azimuthal angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00145">rayfire_mesh.h:145</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a3496824565e791d09a9b5e583e6634a9"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">GRINS::RayfireMesh::_theta</a></div><div class="ttdeci">libMesh::Real _theta</div><div class="ttdoc">Rayfire Spherical polar angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00142">rayfire_mesh.h:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3e813ee40abf0b3c7317d9b394a9b304"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GRINS::RayfireMesh::RayfireMesh </td>
          <td>(</td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Real&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Real&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>3D Constructor </p>
<p>This is restricted to 3D meshes. The <a class="el" href="classGRINS_1_1RayfireMesh.html#ad1db884a1ec3202addc1cfa27ba11933" title="Initialization. ">init()</a> function must be called to perform the actual rayfire. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">origin</td><td>Origin point (x,y,z) of the rayfire on mesh boundary </td></tr>
    <tr><td class="paramname">theta</td><td>Spherical polar angle (in radians) </td></tr>
    <tr><td class="paramname">phi</td><td>Spherical azimuthal angle (in radians) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00041">41</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                                                                   :</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">_dim</a>(3),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>(origin),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a>(theta),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a55348114d2a7c62c74ba9d9d8ee5e289">_phi</a>(phi)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    libmesh_not_implemented();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ab8d4f4fceea9148cd24697418455ca2d"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">GRINS::RayfireMesh::_origin</a></div><div class="ttdeci">libMesh::Point _origin</div><div class="ttdoc">Origin point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00139">rayfire_mesh.h:139</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a21ac01d53d82a291dbd0d9219a4435fe"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">GRINS::RayfireMesh::_dim</a></div><div class="ttdeci">const unsigned int _dim</div><div class="ttdoc">Dimension of the main mesh. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00136">rayfire_mesh.h:136</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a55348114d2a7c62c74ba9d9d8ee5e289"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a55348114d2a7c62c74ba9d9d8ee5e289">GRINS::RayfireMesh::_phi</a></div><div class="ttdeci">libMesh::Real _phi</div><div class="ttdoc">Rayfire Spherical azimuthal angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00145">rayfire_mesh.h:145</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a3496824565e791d09a9b5e583e6634a9"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">GRINS::RayfireMesh::_theta</a></div><div class="ttdeci">libMesh::Real _theta</div><div class="ttdoc">Rayfire Spherical polar angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00142">rayfire_mesh.h:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a98e0b8744a5173e0f615cbe6363075b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GRINS::RayfireMesh::RayfireMesh </td>
          <td>(</td>
          <td class="paramtype">const GetPot &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>qoi_string</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Input File Constructor. </p>
<p>Creates rayfire from parameters specified in input file section: QoI/'qoi_string'/Rayfire/ </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00061">61</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00139">_origin</a>, <a class="el" href="rayfire__mesh_8h_source.html#l00142">_theta</a>, and <a class="el" href="math__constants_8h_source.html#l00036">GRINS::Constants::pi</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                                                             :</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">_dim</a>(2),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a55348114d2a7c62c74ba9d9d8ee5e289">_phi</a>(-7.0)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rayfire_dim = input.vector_variable_size(<span class="stringliteral">&quot;QoI/&quot;</span>+qoi_string+<span class="stringliteral">&quot;/Rayfire/origin&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (rayfire_dim != 2)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;ERROR: Only 2D Rayfires are currently supported&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">if</span> (!input.have_variable(<span class="stringliteral">&quot;QoI/&quot;</span>+qoi_string+<span class="stringliteral">&quot;/Rayfire/origin&quot;</span>))</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;ERROR: No origin specified for Rayfire&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">if</span> (input.vector_variable_size(<span class="stringliteral">&quot;QoI/&quot;</span>+qoi_string+<span class="stringliteral">&quot;/Rayfire/origin&quot;</span>) != 2)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;ERROR: Please specify a 2D point (x,y) for the rayfire origin&quot;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    libMesh::Point origin;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>(0) = input(<span class="stringliteral">&quot;QoI/&quot;</span>+qoi_string+<span class="stringliteral">&quot;/Rayfire/origin&quot;</span>, 0.0, 0);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>(1) = input(<span class="stringliteral">&quot;QoI/&quot;</span>+qoi_string+<span class="stringliteral">&quot;/Rayfire/origin&quot;</span>, 0.0, 1);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (input.have_variable(<span class="stringliteral">&quot;QoI/&quot;</span>+qoi_string+<span class="stringliteral">&quot;/Rayfire/theta&quot;</span>))</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a> = input(<span class="stringliteral">&quot;QoI/&quot;</span>+qoi_string+<span class="stringliteral">&quot;/Rayfire/theta&quot;</span>, -7.0);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;ERROR: Spherical polar angle theta must be given for Rayfire&quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (std::abs(<a class="code" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a>) &gt; 2.0*<a class="code" href="namespaceGRINS_1_1Constants.html#a597bccbbe42021c9b682558e2a94e2f7">Constants::pi</a>)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;Please supply a theta value between -2*pi and 2*pi&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (input.have_variable(<span class="stringliteral">&quot;QoI/&quot;</span>+qoi_string+<span class="stringliteral">&quot;/Rayfire/phi&quot;</span>))</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;ERROR: cannot specify spherical azimuthal angle phi for Rayfire, only 2D is currently supported&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  }</div>
<div class="ttc" id="namespaceGRINS_1_1Constants_html_a597bccbbe42021c9b682558e2a94e2f7"><div class="ttname"><a href="namespaceGRINS_1_1Constants.html#a597bccbbe42021c9b682558e2a94e2f7">GRINS::Constants::pi</a></div><div class="ttdeci">const libMesh::Real pi</div><div class="ttdef"><b>Definition:</b> <a href="math__constants_8h_source.html#l00036">math_constants.h:36</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ab8d4f4fceea9148cd24697418455ca2d"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">GRINS::RayfireMesh::_origin</a></div><div class="ttdeci">libMesh::Point _origin</div><div class="ttdoc">Origin point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00139">rayfire_mesh.h:139</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a21ac01d53d82a291dbd0d9219a4435fe"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">GRINS::RayfireMesh::_dim</a></div><div class="ttdeci">const unsigned int _dim</div><div class="ttdoc">Dimension of the main mesh. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00136">rayfire_mesh.h:136</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a55348114d2a7c62c74ba9d9d8ee5e289"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a55348114d2a7c62c74ba9d9d8ee5e289">GRINS::RayfireMesh::_phi</a></div><div class="ttdeci">libMesh::Real _phi</div><div class="ttdoc">Rayfire Spherical azimuthal angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00145">rayfire_mesh.h:145</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a3496824565e791d09a9b5e583e6634a9"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">GRINS::RayfireMesh::_theta</a></div><div class="ttdeci">libMesh::Real _theta</div><div class="ttdoc">Rayfire Spherical polar angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00142">rayfire_mesh.h:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa0e77e4d3278ed740d1f9f9e19ce91e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">GRINS::RayfireMesh::RayfireMesh </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classGRINS_1_1RayfireMesh.html">RayfireMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>original</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy Constructor. </p>
<p>Required to deep-copy _mesh and _elem_id_map </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00092">92</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00151">_elem_id_map</a>, and <a class="el" href="rayfire__mesh_8h_source.html#l00148">_mesh</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                                       :</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">_dim</a>(original._dim),</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>(original._origin),</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a>(original._theta),</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#a55348114d2a7c62c74ba9d9d8ee5e289">_phi</a>(original._phi)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (original._mesh.get())</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>.reset( <span class="keyword">new</span> libMesh::Mesh( *((original._mesh).get()) ) );</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a> = original._elem_id_map;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_af2c3dd53b7aeb5fc90accac7cc2f4a5f"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">GRINS::RayfireMesh::_mesh</a></div><div class="ttdeci">libMesh::UniquePtr&lt; libMesh::Mesh &gt; _mesh</div><div class="ttdoc">Internal 1D mesh of EDGE2 elements. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00148">rayfire_mesh.h:148</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ab8d4f4fceea9148cd24697418455ca2d"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">GRINS::RayfireMesh::_origin</a></div><div class="ttdeci">libMesh::Point _origin</div><div class="ttdoc">Origin point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00139">rayfire_mesh.h:139</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a4444026efd745db379c306522eb1abae"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">GRINS::RayfireMesh::_elem_id_map</a></div><div class="ttdeci">std::map&lt; libMesh::dof_id_type, libMesh::dof_id_type &gt; _elem_id_map</div><div class="ttdoc">Map of main mesh elem_id to rayfire mesh elem_id. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00151">rayfire_mesh.h:151</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a21ac01d53d82a291dbd0d9219a4435fe"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">GRINS::RayfireMesh::_dim</a></div><div class="ttdeci">const unsigned int _dim</div><div class="ttdoc">Dimension of the main mesh. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00136">rayfire_mesh.h:136</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a55348114d2a7c62c74ba9d9d8ee5e289"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a55348114d2a7c62c74ba9d9d8ee5e289">GRINS::RayfireMesh::_phi</a></div><div class="ttdeci">libMesh::Real _phi</div><div class="ttdoc">Rayfire Spherical azimuthal angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00145">rayfire_mesh.h:145</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a3496824565e791d09a9b5e583e6634a9"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">GRINS::RayfireMesh::_theta</a></div><div class="ttdeci">libMesh::Real _theta</div><div class="ttdoc">Rayfire Spherical polar angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00142">rayfire_mesh.h:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3468c4e01f951bfaa7078b3317bb7787"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">GRINS::RayfireMesh::RayfireMesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>User should never call the default constructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aaa5770c975074c01d2c20962fdd6e074"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GRINS::RayfireMesh::check_origin_on_boundary </td>
          <td>(</td>
          <td class="paramtype">const libMesh::Elem *&#160;</td>
          <td class="paramname"><em>start_elem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ensure the supplied origin is on a boundary of the mesh. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00247">247</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00139">_origin</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00104">init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    libmesh_assert(start_elem);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// first, make sure the elem is on a boundary</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">if</span> ( !(start_elem-&gt;on_boundary()) )</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;The supplied origin point is not on a boundary element&quot;</span>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// second, check all boundary sides of the elem</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// to see if one of them conatins the origin point</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">bool</span> valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s=0; s&lt;start_elem-&gt;n_sides(); s++)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">// neighbor_ptr() returns NULL on boundary elems</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">if</span> ( start_elem-&gt;neighbor_ptr(s) )</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">// we found a boundary elem, so make an edge and see if it contains the origin</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        libMesh::UniquePtr&lt;const libMesh::Elem&gt; edge_elem = start_elem-&gt;build_edge_ptr(s);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        valid |= edge_elem-&gt;contains_point(<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;The supplied origin point is not on the boundary of the starting element&quot;</span>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ab8d4f4fceea9148cd24697418455ca2d"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">GRINS::RayfireMesh::_origin</a></div><div class="ttdeci">libMesh::Point _origin</div><div class="ttdoc">Origin point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00139">rayfire_mesh.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a498f0a29729d7a3b81e87af0beb1e6cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool GRINS::RayfireMesh::check_valid_point </td>
          <td>(</td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>intersection_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>start_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const libMesh::Elem &amp;&#160;</td>
          <td class="paramname"><em>edge_elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>next_point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ensure the calculated intersection point is on the edge_elem and is not the start_point. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00355">355</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00323">get_next_elem()</a>.</p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordtype">bool</span> is_not_start = !(intersection_point.absolute_fuzzy_equals(start_point));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">bool</span> is_on_edge = edge_elem.contains_point(intersection_point);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordtype">bool</span> is_valid = is_not_start &amp;&amp; is_on_edge;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> ( is_valid )</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        next_point(0) = intersection_point(0);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        next_point(1) = intersection_point(1);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">return</span> is_valid;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a91d1c21e91df24fa119934047ca7e58b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GRINS::RayfireMesh::coarsen </td>
          <td>(</td>
          <td class="paramtype">const libMesh::Elem *&#160;</td>
          <td class="paramname"><em>rayfire_elem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Coarsening of a rayfire element whose main mesh counterpart was coarsened. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00731">731</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00151">_elem_id_map</a>, <a class="el" href="rayfire__mesh_8h_source.html#l00148">_mesh</a>, <a class="el" href="rayfire__mesh_8h_source.html#l00139">_origin</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00308">get_rayfire_elem()</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00198">reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    libmesh_assert(child_elem);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a23d9e910b017b4e86d80f681df3c515f">get_rayfire_elem</a>(child_elem-&gt;id()))</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keyword">const</span> libMesh::Elem* parent_elem = child_elem-&gt;parent();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        libmesh_assert(parent_elem);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keyword">const</span> libMesh::Node* start_node = NULL;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keyword">const</span> libMesh::Node* end_node = NULL;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c=0; c&lt;parent_elem-&gt;n_children(); c++)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            libMesh::Elem* rayfire_child = this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a23d9e910b017b4e86d80f681df3c515f">get_rayfire_elem</a>(parent_elem-&gt;child_ptr(c)-&gt;id());</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordflow">if</span> (rayfire_child)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;              {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="keywordflow">if</span> (!start_node)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                  {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    start_node = rayfire_child-&gt;node_ptr(0);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    end_node = rayfire_child-&gt;node_ptr(1);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                  }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                  {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                    <span class="keywordflow">if</span> ( (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a> - *(rayfire_child-&gt;node_ptr(0))).norm() &lt; (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a> - *start_node).norm() )</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                      start_node = rayfire_child-&gt;node_ptr(0);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                    <span class="keywordflow">if</span> ( (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a> - *(rayfire_child-&gt;node_ptr(1))).norm() &gt; (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a> - *end_node).norm() )</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                      end_node = rayfire_child-&gt;node_ptr(1);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                  }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                rayfire_child-&gt;set_refinement_flag(libMesh::Elem::RefinementState::INACTIVE);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;              }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;          } <span class="comment">// for c</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="comment">// make sure we found nodes</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        libmesh_assert(start_node);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        libmesh_assert(end_node);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">// add a new rayfire elem</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        libMesh::Elem* elem = <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;add_elem(<span class="keyword">new</span> libMesh::Edge2);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        elem-&gt;set_node(0) = <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;node_ptr(start_node-&gt;id());</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        elem-&gt;set_node(1) = <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;node_ptr(end_node-&gt;id());</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        libmesh_assert_less( (*(elem-&gt;node_ptr(0))-<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>).norm(),  (*(elem-&gt;node_ptr(1))-<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>).norm());</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="comment">// add new rayfire elem to the map</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a>[parent_elem-&gt;id()] = elem-&gt;id();</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_af2c3dd53b7aeb5fc90accac7cc2f4a5f"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">GRINS::RayfireMesh::_mesh</a></div><div class="ttdeci">libMesh::UniquePtr&lt; libMesh::Mesh &gt; _mesh</div><div class="ttdoc">Internal 1D mesh of EDGE2 elements. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00148">rayfire_mesh.h:148</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a23d9e910b017b4e86d80f681df3c515f"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a23d9e910b017b4e86d80f681df3c515f">GRINS::RayfireMesh::get_rayfire_elem</a></div><div class="ttdeci">libMesh::Elem * get_rayfire_elem(const libMesh::dof_id_type elem_id)</div><div class="ttdoc">Private function to get a rayfire elem from main_mesh elem ID. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00308">rayfire_mesh.C:308</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ab8d4f4fceea9148cd24697418455ca2d"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">GRINS::RayfireMesh::_origin</a></div><div class="ttdeci">libMesh::Point _origin</div><div class="ttdoc">Origin point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00139">rayfire_mesh.h:139</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a4444026efd745db379c306522eb1abae"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">GRINS::RayfireMesh::_elem_id_map</a></div><div class="ttdeci">std::map&lt; libMesh::dof_id_type, libMesh::dof_id_type &gt; _elem_id_map</div><div class="ttdoc">Map of main mesh elem_id to rayfire mesh elem_id. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00151">rayfire_mesh.h:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac461ae6a5878263663f72c879ae99f36"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GRINS::RayfireMesh::elem_ids_in_rayfire </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; libMesh::dof_id_type &gt; &amp;&#160;</td>
          <td class="paramname"><em>id_vector</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a vector of elem IDs that are currently along the rayfire. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00187">187</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00151">_elem_id_map</a>, and <a class="el" href="rayfire__mesh_8h_source.html#l00148">_mesh</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    std::map&lt;libMesh::dof_id_type,libMesh::dof_id_type&gt;::const_iterator it = <a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a>.begin();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">for</span>(; it != <a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a>.end(); it++)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;elem_ptr(it-&gt;second)-&gt;active())</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          id_vector.push_back(it-&gt;first);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_af2c3dd53b7aeb5fc90accac7cc2f4a5f"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">GRINS::RayfireMesh::_mesh</a></div><div class="ttdeci">libMesh::UniquePtr&lt; libMesh::Mesh &gt; _mesh</div><div class="ttdoc">Internal 1D mesh of EDGE2 elements. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00148">rayfire_mesh.h:148</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a4444026efd745db379c306522eb1abae"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">GRINS::RayfireMesh::_elem_id_map</a></div><div class="ttdeci">std::map&lt; libMesh::dof_id_type, libMesh::dof_id_type &gt; _elem_id_map</div><div class="ttdoc">Map of main mesh elem_id to rayfire mesh elem_id. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00151">rayfire_mesh.h:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad2f8b0ec9569200fd1e8cb5806a4d3f1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const libMesh::Elem * GRINS::RayfireMesh::get_correct_neighbor </td>
          <td>(</td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>start_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>end_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const libMesh::Elem *&#160;</td>
          <td class="paramname"><em>cur_elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>same_parent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Knowing the end_point, get the appropraite next elem along the path. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00432">432</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8C_source.html#l00372">rayfire_in_elem()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00392">validate_edge()</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00323">get_next_elem()</a>.</p>
<div class="fragment"><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    libmesh_assert(cur_elem);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    libmesh_assert(cur_elem-&gt;active());</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keyword">const</span> libMesh::Elem * neighbor = cur_elem-&gt;neighbor_ptr(side);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">// a valid neighbor is an ACTIVE elem or null</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">bool</span> is_valid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (neighbor)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      is_valid = neighbor-&gt;active();</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (is_valid)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">// check if the intersection point is a vertex</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordtype">bool</span> is_vertex = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keyword">const</span> libMesh::Node * vertex = NULL;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;cur_elem-&gt;n_nodes(); n++)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">if</span> ((cur_elem-&gt;node_ptr(n))-&gt;absolute_fuzzy_equals(end_point))</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;              {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                is_vertex = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                vertex = cur_elem-&gt;node_ptr(n);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;              }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">if</span> (is_vertex)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="comment">// rayfire goes through vertex</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="comment">// check elem neighbors first</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s=0; s&lt;cur_elem-&gt;n_sides(); s++)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;              {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                libMesh::UniquePtr&lt;const libMesh::Elem&gt; side_elem = cur_elem-&gt;build_side_ptr(s);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="keywordflow">if</span> (side_elem-&gt;contains_point(end_point))</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                  {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    <span class="keyword">const</span> libMesh::Elem * neighbor = cur_elem-&gt;neighbor_ptr(s);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    <span class="keywordflow">if</span> (!neighbor)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    <span class="keywordflow">if</span> (same_parent)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                      {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        <span class="keywordflow">if</span> (neighbor-&gt;parent())</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                          {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                            <span class="keywordflow">if</span> (neighbor-&gt;parent()-&gt;id() != cur_elem-&gt;parent()-&gt;id())</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                              <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">rayfire_in_elem</a>(end_point,neighbor))</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a66e1db520895502349af00fa70391ac3">validate_edge</a>(start_point,end_point,side_elem.get(),neighbor))</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                  <span class="keywordflow">return</span> neighbor;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                          }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                      }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">rayfire_in_elem</a>(end_point,neighbor))</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a66e1db520895502349af00fa70391ac3">validate_edge</a>(start_point,end_point,side_elem.get(),neighbor))</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                          <span class="keywordflow">return</span> neighbor;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                  }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;              }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="comment">// next elem is not a neighbor,</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="comment">// so get all elems that share this vertex</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            std::set&lt;const libMesh::Elem*&gt; elem_set;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            cur_elem-&gt;find_point_neighbors(*vertex,elem_set);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            std::set&lt;const libMesh::Elem *&gt;::const_iterator       it  = elem_set.begin();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keyword">const</span> std::set&lt;const libMesh::Elem *&gt;::const_iterator end = elem_set.end();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="comment">// iterate over each elem</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">for</span> (; it != end; ++it)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;              {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keyword">const</span> libMesh::Elem* elem = *it;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="keywordflow">if</span> (elem == cur_elem) <span class="comment">// skip the current elem</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                  <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">rayfire_in_elem</a>(end_point,elem))</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                  <span class="keywordflow">return</span> elem;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;              }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;          }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;          {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <span class="comment">// check if side is a boundary</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordflow">if</span>( !(cur_elem-&gt;neighbor_ptr(side)) )</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;              <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="comment">// not a vertex or boundary, so just get the elem on that side</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="keywordflow">return</span> cur_elem-&gt;neighbor_ptr(side);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;          }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      } <span class="comment">// if (is_valid)</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c=0; c&lt;neighbor-&gt;n_children(); c++)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;          {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keyword">const</span> libMesh::Elem * child = neighbor-&gt;child_ptr(c);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordflow">if</span> (child-&gt;contains_point(end_point))</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;              <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">rayfire_in_elem</a>(end_point,child))</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">return</span> child;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="comment">// could not find a valid child elem, so we return NULL below</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a66e1db520895502349af00fa70391ac3"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a66e1db520895502349af00fa70391ac3">GRINS::RayfireMesh::validate_edge</a></div><div class="ttdeci">bool validate_edge(const libMesh::Point &amp;start_point, const libMesh::Point &amp;end_point, const libMesh::Elem *side_elem, const libMesh::Elem *neighbor)</div><div class="ttdoc">Ensures the rayfire doesn&#39;t wander into the middle of an elem. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00392">rayfire_mesh.C:392</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a69149972a2c2b212da4dfea87254c935"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">GRINS::RayfireMesh::rayfire_in_elem</a></div><div class="ttdeci">bool rayfire_in_elem(const libMesh::Point &amp;end_point, const libMesh::Elem *elem)</div><div class="ttdoc">Walks a short distance along the rayfire and checks if elem contains that point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00372">rayfire_mesh.C:372</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0e41959f10c48e69fa51348da8bda055"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const libMesh::Elem * GRINS::RayfireMesh::get_next_elem </td>
          <td>(</td>
          <td class="paramtype">const libMesh::Elem *&#160;</td>
          <td class="paramname"><em>cur_elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>start_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>end_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>same_parent</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the intersection point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">end_point</td><td>The intersection point in (x,y) coordinates </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Elem* if intersection is found </dd>
<dd>
NULL if no intersection point found (i.e. start_point is on a boundary) </dd></dl>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00323">323</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8C_source.html#l00355">check_valid_point()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00432">get_correct_neighbor()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00541">newton_solve_intersection()</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00104">init()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00618">refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    libmesh_assert(cur_elem);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    libMesh::Point intersection_point;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// loop over all sides of the elem and check each one for intersection</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s=0; s&lt;cur_elem-&gt;n_sides(); s++)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        libMesh::UniquePtr&lt;const libMesh::Elem&gt; edge_elem = cur_elem-&gt;build_edge_ptr(s);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment">// Using the default tol can cause a false positive when start_point is near a node,</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment">// causing this loop to skip over an otherwise valid edge to check</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">if</span> (edge_elem-&gt;contains_point(start_point,libMesh::TOLERANCE*0.1))</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordtype">bool</span> converged = this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a75c657ad438157c9d522c9feeac1eb25">newton_solve_intersection</a>(start_point,edge_elem.get(),intersection_point);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">if</span> (converged)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;          {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a498f0a29729d7a3b81e87af0beb1e6cb">check_valid_point</a>(intersection_point,start_point,*edge_elem,next_point) )</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;              <span class="keywordflow">return</span> this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#ad2f8b0ec9569200fd1e8cb5806a4d3f1">get_correct_neighbor</a>(start_point,intersection_point,cur_elem,s,same_parent);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      } <span class="comment">// for s</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">return</span> NULL; <span class="comment">// no intersection</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a498f0a29729d7a3b81e87af0beb1e6cb"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a498f0a29729d7a3b81e87af0beb1e6cb">GRINS::RayfireMesh::check_valid_point</a></div><div class="ttdeci">bool check_valid_point(libMesh::Point &amp;intersection_point, libMesh::Point &amp;start_point, const libMesh::Elem &amp;edge_elem, libMesh::Point &amp;next_point)</div><div class="ttdoc">Ensure the calculated intersection point is on the edge_elem and is not the start_point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00355">rayfire_mesh.C:355</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ad2f8b0ec9569200fd1e8cb5806a4d3f1"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ad2f8b0ec9569200fd1e8cb5806a4d3f1">GRINS::RayfireMesh::get_correct_neighbor</a></div><div class="ttdeci">const libMesh::Elem * get_correct_neighbor(libMesh::Point &amp;start_point, libMesh::Point &amp;end_point, const libMesh::Elem *cur_elem, unsigned int side, bool same_parent)</div><div class="ttdoc">Knowing the end_point, get the appropraite next elem along the path. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00432">rayfire_mesh.C:432</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a75c657ad438157c9d522c9feeac1eb25"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a75c657ad438157c9d522c9feeac1eb25">GRINS::RayfireMesh::newton_solve_intersection</a></div><div class="ttdeci">bool newton_solve_intersection(libMesh::Point &amp;initial_point, const libMesh::Elem *edge_elem, libMesh::Point &amp;intersection_point)</div><div class="ttdoc">Iterative solver for calculating the intersection point of the rayfire on the side of an elem...</div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00541">rayfire_mesh.C:541</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a23d9e910b017b4e86d80f681df3c515f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::Elem * GRINS::RayfireMesh::get_rayfire_elem </td>
          <td>(</td>
          <td class="paramtype">const libMesh::dof_id_type&#160;</td>
          <td class="paramname"><em>elem_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Private function to get a rayfire elem from main_mesh elem ID. </p>
<p>Does not return a const pointer, and is used within this class to simplify rayfire elem access.</p>
<p>Also used by <a class="el" href="classGRINS_1_1RayfireMesh.html#a66248d3ab42b1fbcd354433303c92b9a" title="This function takes in an elem_id on the main mesh and returns an elem from the 1D rayfire mesh...">map_to_rayfire_elem()</a>, which adds a const to prevent modification outside this class. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00308">308</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00151">_elem_id_map</a>, and <a class="el" href="rayfire__mesh_8h_source.html#l00148">_mesh</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00731">coarsen()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00181">map_to_rayfire_elem()</a>.</p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// return value; set if valid rayfire elem is found</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    libMesh::Elem* retval = NULL;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    std::map&lt;libMesh::dof_id_type,libMesh::dof_id_type&gt;::iterator it;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    it = <a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a>.find(elem_id);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (it != <a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a>.end())</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;elem_ptr(it-&gt;second)-&gt;refinement_flag() != libMesh::Elem::RefinementState::INACTIVE)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        retval = <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;elem_ptr(it-&gt;second);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_af2c3dd53b7aeb5fc90accac7cc2f4a5f"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">GRINS::RayfireMesh::_mesh</a></div><div class="ttdeci">libMesh::UniquePtr&lt; libMesh::Mesh &gt; _mesh</div><div class="ttdoc">Internal 1D mesh of EDGE2 elements. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00148">rayfire_mesh.h:148</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a4444026efd745db379c306522eb1abae"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">GRINS::RayfireMesh::_elem_id_map</a></div><div class="ttdeci">std::map&lt; libMesh::dof_id_type, libMesh::dof_id_type &gt; _elem_id_map</div><div class="ttdoc">Map of main mesh elem_id to rayfire mesh elem_id. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00151">rayfire_mesh.h:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af0e858574528656b3ecac0b15148e4b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const libMesh::Elem * GRINS::RayfireMesh::get_start_elem </td>
          <td>(</td>
          <td class="paramtype">const libMesh::MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh_base</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the correct starting elem corresponding to _origin. </p>
<dl class="section return"><dt>Returns</dt><dd>NULL Origin is not on the mesh </dd>
<dd>
Elem* First elem on the rayfire </dd></dl>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00275">275</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00139">_origin</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00372">rayfire_in_elem()</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00104">init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keyword">const</span> libMesh::Elem* start_elem = NULL;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    libMesh::UniquePtr&lt;libMesh::PointLocatorBase&gt; locator = mesh_base.sub_point_locator();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keyword">const</span> libMesh::Elem* elem = (*locator)(<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// elem would be NULL if origin is not on mesh</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">if</span> (elem)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">rayfire_in_elem</a>(<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>,elem))</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          start_elem = elem;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;elem-&gt;n_neighbors(); i++)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;              {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="keyword">const</span> libMesh::Elem* neighbor_elem = elem-&gt;neighbor_ptr(i);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <span class="keywordflow">if</span> (!neighbor_elem)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                  <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">rayfire_in_elem</a>(<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>,neighbor_elem))</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                  {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    start_elem = neighbor_elem;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                  }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;              }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">return</span> start_elem; <span class="comment">// might be NULL if _origin is not on mesh</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ab8d4f4fceea9148cd24697418455ca2d"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">GRINS::RayfireMesh::_origin</a></div><div class="ttdeci">libMesh::Point _origin</div><div class="ttdoc">Origin point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00139">rayfire_mesh.h:139</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a69149972a2c2b212da4dfea87254c935"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">GRINS::RayfireMesh::rayfire_in_elem</a></div><div class="ttdeci">bool rayfire_in_elem(const libMesh::Point &amp;end_point, const libMesh::Elem *elem)</div><div class="ttdoc">Walks a short distance along the rayfire and checks if elem contains that point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00372">rayfire_mesh.C:372</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad1db884a1ec3202addc1cfa27ba11933"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GRINS::RayfireMesh::init </td>
          <td>(</td>
          <td class="paramtype">const libMesh::MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh_base</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialization. </p>
<p>This function performs the rayfire and assembles the 1D mesh. Call this immediately after the constructor. Must be called before any refinements of the main mesh. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh_base</td><td>Reference to the main mesh </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00104">104</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00136">_dim</a>, <a class="el" href="rayfire__mesh_8h_source.html#l00151">_elem_id_map</a>, <a class="el" href="rayfire__mesh_8h_source.html#l00148">_mesh</a>, <a class="el" href="rayfire__mesh_8h_source.html#l00139">_origin</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00247">check_origin_on_boundary()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00323">get_next_elem()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00275">get_start_elem()</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// consistency check</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span>(mesh_base.mesh_dimension() != <a class="code" href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">_dim</a>)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        ss &lt;&lt;<span class="stringliteral">&quot;The supplied mesh object is &quot;</span> &lt;&lt;mesh_base.mesh_dimension()</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;           &lt;&lt;<span class="stringliteral">&quot;D, but the RayfireMesh object was created with the &quot;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;           &lt;&lt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">_dim</a> &lt;&lt;<span class="stringliteral">&quot;D constructor&quot;</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        libmesh_error_msg(ss.str());</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>.reset( <span class="keyword">new</span> libMesh::Mesh(mesh_base.comm(),(<span class="keywordtype">unsigned</span> char)1) );</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    libMesh::Point start_point(<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// get first element</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">const</span> libMesh::Elem* start_elem = this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#af0e858574528656b3ecac0b15148e4b6">get_start_elem</a>(mesh_base);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (!start_elem)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;Origin is not on mesh&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// ensure the origin is on a boundary element</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// AND on the boundary of said element</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#aaa5770c975074c01d2c20962fdd6e074">check_origin_on_boundary</a>(start_elem);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// add the origin point to the point list</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    libMesh::Node * start_node = <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;add_point(start_point);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    libMesh::Node * end_node = NULL;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    libMesh::Point end_point;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keyword">const</span> libMesh::Elem* next_elem;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keyword">const</span> libMesh::Elem* prev_elem = start_elem;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// calculate the end point and</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// get the next elem in the rayfire</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        next_elem = this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a0e41959f10c48e69fa51348da8bda055">get_next_elem</a>(prev_elem,start_point,end_point);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// make sure we are only picking up active elements</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (next_elem)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          libmesh_assert( next_elem-&gt;active() );</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// add end point as node on the rayfire mesh</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        end_node = <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;add_point(end_point);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        libMesh::Elem* elem = <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;add_elem(<span class="keyword">new</span> libMesh::Edge2);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        elem-&gt;set_node(0) = start_node;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        elem-&gt;set_node(1) = end_node;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// warn if rayfire elem is shorter than TOLERANCE</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> ( (start_point-end_point).norm() &lt; libMesh::TOLERANCE)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            std::stringstream ss;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            ss  &lt;&lt;<span class="stringliteral">&quot;********\n&quot;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                &lt;&lt;<span class="stringliteral">&quot;WARNING\n&quot;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                &lt;&lt;<span class="stringliteral">&quot;Detected rayfire element shorter than TOLERANCE\n&quot;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                &lt;&lt;<span class="stringliteral">&quot;Element ID: &quot;</span> &lt;&lt;prev_elem-&gt;id() &lt;&lt;<span class="stringliteral">&quot;, rayfire element length: &quot;</span> &lt;&lt;(start_point-end_point).norm();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            libmesh_warning(ss.str());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="comment">// add new rayfire elem to the map</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a>[prev_elem-&gt;id()] = elem-&gt;id();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        start_point = end_point;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        start_node = end_node;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        prev_elem = next_elem;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      } <span class="keywordflow">while</span>(next_elem);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a0e41959f10c48e69fa51348da8bda055"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a0e41959f10c48e69fa51348da8bda055">GRINS::RayfireMesh::get_next_elem</a></div><div class="ttdeci">const libMesh::Elem * get_next_elem(const libMesh::Elem *cur_elem, libMesh::Point &amp;start_point, libMesh::Point &amp;end_point, bool same_parent=false)</div><div class="ttdoc">Calculate the intersection point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00323">rayfire_mesh.C:323</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_af2c3dd53b7aeb5fc90accac7cc2f4a5f"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">GRINS::RayfireMesh::_mesh</a></div><div class="ttdeci">libMesh::UniquePtr&lt; libMesh::Mesh &gt; _mesh</div><div class="ttdoc">Internal 1D mesh of EDGE2 elements. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00148">rayfire_mesh.h:148</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ab8d4f4fceea9148cd24697418455ca2d"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">GRINS::RayfireMesh::_origin</a></div><div class="ttdeci">libMesh::Point _origin</div><div class="ttdoc">Origin point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00139">rayfire_mesh.h:139</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_af0e858574528656b3ecac0b15148e4b6"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#af0e858574528656b3ecac0b15148e4b6">GRINS::RayfireMesh::get_start_elem</a></div><div class="ttdeci">const libMesh::Elem * get_start_elem(const libMesh::MeshBase &amp;mesh_base)</div><div class="ttdoc">Get the correct starting elem corresponding to _origin. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00275">rayfire_mesh.C:275</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a4444026efd745db379c306522eb1abae"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">GRINS::RayfireMesh::_elem_id_map</a></div><div class="ttdeci">std::map&lt; libMesh::dof_id_type, libMesh::dof_id_type &gt; _elem_id_map</div><div class="ttdoc">Map of main mesh elem_id to rayfire mesh elem_id. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00151">rayfire_mesh.h:151</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a21ac01d53d82a291dbd0d9219a4435fe"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a21ac01d53d82a291dbd0d9219a4435fe">GRINS::RayfireMesh::_dim</a></div><div class="ttdeci">const unsigned int _dim</div><div class="ttdoc">Dimension of the main mesh. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00136">rayfire_mesh.h:136</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_aaa5770c975074c01d2c20962fdd6e074"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#aaa5770c975074c01d2c20962fdd6e074">GRINS::RayfireMesh::check_origin_on_boundary</a></div><div class="ttdeci">void check_origin_on_boundary(const libMesh::Elem *start_elem)</div><div class="ttdoc">Ensure the supplied origin is on a boundary of the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00247">rayfire_mesh.C:247</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a66248d3ab42b1fbcd354433303c92b9a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const libMesh::Elem * GRINS::RayfireMesh::map_to_rayfire_elem </td>
          <td>(</td>
          <td class="paramtype">const libMesh::dof_id_type&#160;</td>
          <td class="paramname"><em>elem_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes in an elem_id on the main mesh and returns an elem from the 1D rayfire mesh. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">elem_id</td><td>The ID of the elem on the main mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Elem* to 1D elem from the rayfire mesh if the elem_id falls along the rayfire path </dd>
<dd>
NULL if the given elem_id does not correspond to an elem through which the rayfire passes </dd></dl>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00181">181</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8C_source.html#l00308">get_rayfire_elem()</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a23d9e910b017b4e86d80f681df3c515f">get_rayfire_elem</a>(elem_id);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a23d9e910b017b4e86d80f681df3c515f"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a23d9e910b017b4e86d80f681df3c515f">GRINS::RayfireMesh::get_rayfire_elem</a></div><div class="ttdeci">libMesh::Elem * get_rayfire_elem(const libMesh::dof_id_type elem_id)</div><div class="ttdoc">Private function to get a rayfire elem from main_mesh elem ID. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00308">rayfire_mesh.C:308</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a75c657ad438157c9d522c9feeac1eb25"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool GRINS::RayfireMesh::newton_solve_intersection </td>
          <td>(</td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>initial_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const libMesh::Elem *&#160;</td>
          <td class="paramname"><em>edge_elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>intersection_point</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Iterative solver for calculating the intersection point of the rayfire on the side of an elem. </p>
<p>The rayfire line can be represented in point-slope form:</p>
<p>y-y0 = m(x-x0)</p>
<p>where m is the slope and (x0,y0) is the known initial_point. To find the intersection point, we will use a parametric representation of the edge utilizing the shape functions as such:</p>
<p>X(&xi;) = sum( x<sub>j</sub> &phi;<sub>j</sub>(&xi;) )</p>
<p>Y(&xi;) = sum( y<sub>j</sub> &phi;<sub>j</sub>(&xi;) )</p>
<p>where x<sub>j</sub> and y<sub>j</sub> are the node x- and y-coordinates, respectively, and &phi;<sub>j</sub> is the value of shape function j at reference coordinate &xi;</p>
<p>The intersection point is then where the x and y coordinates from the point-slope equation equal the X and Y coordinates from the parametric equations for the given edge, respectively. We can then form a residual by substituting the parametric coordinates into the point slope form and bringing all terms to one side of the equation as:</p>
<p>f = 0 = m(X(&xi;)-x0) - (Y(&xi;)-y0)</p>
<p>The residual is then a function of a single parameter, namely the reference coordinate &xi;. The derivative is rather trivial and can be expressed as</p>
<p>df = m*dX - dY</p>
<p>where</p>
<p>dX = sum( x<sub>j</sub> d&phi;<sub>j</sub>/d&xi; )</p>
<p>dY = sum( y<sub>j</sub> d&phi;<sub>j</sub>/d&xi; )</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">intersection_point</td><td>The calculated intersection point (only set if convergence is achieved) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether or not the solver converged before hitting the iteration limit </dd></dl>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00541">541</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00142">_theta</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00323">get_next_elem()</a>.</p>
<div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    libmesh_assert(edge_elem);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iter_max = 20; <span class="comment">// max iterations</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// the number of shape functions needed for the edge_elem</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sf = libMesh::FE&lt;1,libMesh::LAGRANGE&gt;::n_shape_functions(edge_elem-&gt;type(),edge_elem-&gt;default_order());</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// starting point on the elem</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    libMesh::Real x0 = initial_point(0);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    libMesh::Real y0 = initial_point(1);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">// shape functions and derivatives w.r.t reference coordinate</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    std::vector&lt;libMesh::Real&gt; phi(n_sf);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    std::vector&lt;libMesh::Real&gt; dphi(n_sf);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// Newton iteration step</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    libMesh::Real d_xi;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">// tan(theta) is the slope, so precompute since it is used repeatedly</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    libMesh::Real tan_theta = std::tan(<a class="code" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a>);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">// Initial guess is center of the edge_elem</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    libMesh::Real xi = 0.0;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">// Newton iteration</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> it=0; it&lt;iter_max; it++)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">// Get the shape function and derivative values at the reference coordinate</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">// phi.size() == dphi.size()</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;phi.size(); i++)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;          {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            phi[i] = libMesh::FE&lt;1,libMesh::LAGRANGE&gt;::shape(edge_elem-&gt;type(),</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                                             edge_elem-&gt;default_order(),</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                                             i,</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                                             xi);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            dphi[i] = libMesh::FE&lt;1,libMesh::LAGRANGE&gt;::shape_deriv(edge_elem-&gt;type(),</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                                                    edge_elem-&gt;default_order(),</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                                                    i,</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                                                    0, <span class="comment">// const unsigned int libmesh_dbg_varj</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                                                                    xi);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          } <span class="comment">// for i</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        libMesh::Real X=0.0, Y=0.0, dX=0.0, dY=0.0;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;phi.size(); i++)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            X  += (*(edge_elem-&gt;node_ptr(i)))(0) * phi[i];</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            dX += (*(edge_elem-&gt;node_ptr(i)))(0) * dphi[i];</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            Y  += (*(edge_elem-&gt;node_ptr(i)))(1) * phi[i];</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            dY += (*(edge_elem-&gt;node_ptr(i)))(1) * dphi[i];</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;          }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        libMesh::Real  f = tan_theta*(X-x0) - (Y-y0);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        libMesh::Real df = tan_theta*(dX) - dY;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        d_xi = f/df;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">if</span>(std::abs(d_xi) &lt; libMesh::TOLERANCE)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="comment">// convergence</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            intersection_point(0) = X;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            intersection_point(1) = Y;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          xi -= d_xi;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      } <span class="comment">// for it</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// no convergence</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a3496824565e791d09a9b5e583e6634a9"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">GRINS::RayfireMesh::_theta</a></div><div class="ttdeci">libMesh::Real _theta</div><div class="ttdoc">Rayfire Spherical polar angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00142">rayfire_mesh.h:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a69149972a2c2b212da4dfea87254c935"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool GRINS::RayfireMesh::rayfire_in_elem </td>
          <td>(</td>
          <td class="paramtype">const libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>end_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const libMesh::Elem *&#160;</td>
          <td class="paramname"><em>elem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Walks a short distance along the rayfire and checks if elem contains that point. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00372">372</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00142">_theta</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00432">get_correct_neighbor()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00275">get_start_elem()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00618">refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    libmesh_assert(elem);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// move a little bit along the rayfire and see if we are still in the elem</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// need to move more than TOLERANCE to avoid false positive on contains_point()</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    libMesh::Real L = 2*libMesh::TOLERANCE;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// If the elem is too small, need to shorten L so we stay within the elem</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> ( elem-&gt;hmin() &lt; libMesh::TOLERANCE )</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      L = elem-&gt;hmin() * 0.1;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// parametric representation of rayfire line</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    libMesh::Real x = end_point(0) + L*std::cos(<a class="code" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    libMesh::Real y = end_point(1) + L*std::sin(<a class="code" href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">_theta</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> elem-&gt;contains_point(libMesh::Point(x,y));</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a3496824565e791d09a9b5e583e6634a9"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a3496824565e791d09a9b5e583e6634a9">GRINS::RayfireMesh::_theta</a></div><div class="ttdeci">libMesh::Real _theta</div><div class="ttdoc">Rayfire Spherical polar angle (in radians) </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00142">rayfire_mesh.h:142</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a38be0fb7a492ad0005ef4fabc52baaa6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GRINS::RayfireMesh::refine </td>
          <td>(</td>
          <td class="paramtype">const libMesh::Elem *&#160;</td>
          <td class="paramname"><em>main_elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">libMesh::Elem *&#160;</td>
          <td class="paramname"><em>rayfire_elem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refinement of a rayfire element whose main mesh counterpart was refined. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00618">618</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00151">_elem_id_map</a>, <a class="el" href="rayfire__mesh_8h_source.html#l00148">_mesh</a>, <a class="el" href="rayfire__mesh_8h_source.html#l00139">_origin</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00323">get_next_elem()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00372">rayfire_in_elem()</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00198">reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    libmesh_assert(main_elem);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    libmesh_assert(rayfire_elem);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    libmesh_assert_equal_to(main_elem-&gt;refinement_flag(),libMesh::Elem::RefinementState::INACTIVE);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">// these nodes cannot change</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    libMesh::Node* start_node = rayfire_elem-&gt;node_ptr(0);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    libMesh::Node* end_node   = rayfire_elem-&gt;node_ptr(1);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">// set the rayfire_elem as INACTIVE</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    rayfire_elem-&gt;set_refinement_flag(libMesh::Elem::RefinementState::INACTIVE);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">// find which child elem we start with</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    libMesh::dof_id_type start_child = libMesh::invalid_uint;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;main_elem-&gt;n_children(); i++)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">if</span> ( (main_elem-&gt;child_ptr(i))-&gt;contains_point(*start_node) )</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;          {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="comment">// check if the start point is a vertex</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordtype">bool</span> is_vertex = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;main_elem-&gt;child_ptr(i)-&gt;n_nodes(); n++)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;              {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                <span class="keywordflow">if</span> ((main_elem-&gt;child_ptr(i)-&gt;node_ptr(n))-&gt;absolute_fuzzy_equals(*start_node))</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                  {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    is_vertex = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                  }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;              }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            <span class="keywordflow">if</span> (is_vertex)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;              {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="keywordflow">if</span> ( this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">rayfire_in_elem</a>(*start_node, main_elem-&gt;child_ptr(i)) )</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                  {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    start_child = i;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                  }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;              }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;              {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                start_child = i;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;              }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">// make sure we found a starting child elem</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    libmesh_assert_not_equal_to(start_child,libMesh::invalid_uint);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// we found the starting element, so perform the rayfire</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">// until we reach the stored end_node</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    libMesh::Point start_point = *start_node;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    libMesh::Point end_point;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keyword">const</span> libMesh::Elem* next_elem;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keyword">const</span> libMesh::Elem* prev_elem = main_elem-&gt;child_ptr(start_child);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">// if prev_elem is INACTIVE, then more than one refinement</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// has taken place between reinit() calls and will</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">// break this</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    libmesh_assert_equal_to( prev_elem-&gt;refinement_flag(), libMesh::Elem::RefinementState::JUST_REFINED );</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    libMesh::Node * prev_node = start_node;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    libMesh::Node * new_node = NULL;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">// iterate until we reach the stored end_node</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        next_elem = this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a0e41959f10c48e69fa51348da8bda055">get_next_elem</a>(prev_elem,start_point,end_point,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="comment">// make sure we are only picking up active elements</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keywordflow">if</span> (next_elem)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          libmesh_assert( next_elem-&gt;active() );</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="comment">// add end point as node on the rayfire mesh</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        new_node = <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;add_point(end_point);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        libMesh::Elem* elem = <a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;add_elem(<span class="keyword">new</span> libMesh::Edge2);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        elem-&gt;set_node(0) = prev_node;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        elem-&gt;set_node(1) = new_node;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        libmesh_assert_less( (*(elem-&gt;node_ptr(0))-<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>).norm(),  (*(elem-&gt;node_ptr(1))-<a class="code" href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">_origin</a>).norm());</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="comment">// warn if rayfire elem is shorter than TOLERANCE</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">if</span> ( (start_point-end_point).norm() &lt; libMesh::TOLERANCE)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;          {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            std::stringstream ss;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            ss  &lt;&lt;<span class="stringliteral">&quot;********\n&quot;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                &lt;&lt;<span class="stringliteral">&quot;WARNING\n&quot;</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                &lt;&lt;<span class="stringliteral">&quot;Detected rayfire element shorter than TOLERANCE on refinement\n&quot;</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                &lt;&lt;<span class="stringliteral">&quot;Element ID: &quot;</span> &lt;&lt;prev_elem-&gt;id() &lt;&lt;<span class="stringliteral">&quot;, rayfire element length: &quot;</span> &lt;&lt;(start_point-end_point).norm();</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            libmesh_warning(ss.str());</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;          }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="comment">// set rayfire_elem as the parent of this new elem</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="comment">// in case it gets coarsened</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        elem-&gt;set_parent(rayfire_elem);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="comment">// add new rayfire elem to the map</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a>[prev_elem-&gt;id()] = elem-&gt;id();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        start_point = end_point;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        prev_elem = next_elem;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        prev_node = new_node;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      } <span class="keywordflow">while</span>(!(new_node-&gt;absolute_fuzzy_equals(*end_node)));</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a0e41959f10c48e69fa51348da8bda055"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a0e41959f10c48e69fa51348da8bda055">GRINS::RayfireMesh::get_next_elem</a></div><div class="ttdeci">const libMesh::Elem * get_next_elem(const libMesh::Elem *cur_elem, libMesh::Point &amp;start_point, libMesh::Point &amp;end_point, bool same_parent=false)</div><div class="ttdoc">Calculate the intersection point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00323">rayfire_mesh.C:323</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_af2c3dd53b7aeb5fc90accac7cc2f4a5f"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">GRINS::RayfireMesh::_mesh</a></div><div class="ttdeci">libMesh::UniquePtr&lt; libMesh::Mesh &gt; _mesh</div><div class="ttdoc">Internal 1D mesh of EDGE2 elements. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00148">rayfire_mesh.h:148</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_ab8d4f4fceea9148cd24697418455ca2d"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#ab8d4f4fceea9148cd24697418455ca2d">GRINS::RayfireMesh::_origin</a></div><div class="ttdeci">libMesh::Point _origin</div><div class="ttdoc">Origin point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00139">rayfire_mesh.h:139</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a4444026efd745db379c306522eb1abae"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">GRINS::RayfireMesh::_elem_id_map</a></div><div class="ttdeci">std::map&lt; libMesh::dof_id_type, libMesh::dof_id_type &gt; _elem_id_map</div><div class="ttdoc">Map of main mesh elem_id to rayfire mesh elem_id. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00151">rayfire_mesh.h:151</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a69149972a2c2b212da4dfea87254c935"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a69149972a2c2b212da4dfea87254c935">GRINS::RayfireMesh::rayfire_in_elem</a></div><div class="ttdeci">bool rayfire_in_elem(const libMesh::Point &amp;end_point, const libMesh::Elem *elem)</div><div class="ttdoc">Walks a short distance along the rayfire and checks if elem contains that point. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00372">rayfire_mesh.C:372</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa92b40395eb3d9f854eaf0871ccc056a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GRINS::RayfireMesh::reinit </td>
          <td>(</td>
          <td class="paramtype">const libMesh::MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh_base</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks for refined and coarsened main mesh elements along the rayfire path. </p>
<p>They are then passed to <a class="el" href="classGRINS_1_1RayfireMesh.html#a38be0fb7a492ad0005ef4fabc52baaa6" title="Refinement of a rayfire element whose main mesh counterpart was refined. ">refine()</a> and <a class="el" href="classGRINS_1_1RayfireMesh.html#a91d1c21e91df24fa119934047ca7e58b" title="Coarsening of a rayfire element whose main mesh counterpart was coarsened. ">coarsen()</a>, respectively, to update the rayfire mesh.</p>
<p>Only 1 level of refinement and/or coarsening can be done between <a class="el" href="classGRINS_1_1RayfireMesh.html#aa92b40395eb3d9f854eaf0871ccc056a" title="Checks for refined and coarsened main mesh elements along the rayfire path. ">reinit()</a> calls. Note that this is not limited to doing either refinement or coarsening between reinits. Both can be done on different elements, as long as they are only 1 level in either direction. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>reference to main mesh, needed to get Elem* from the stored elem_id's </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00198">198</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>References <a class="el" href="rayfire__mesh_8h_source.html#l00151">_elem_id_map</a>, <a class="el" href="rayfire__mesh_8h_source.html#l00148">_mesh</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00731">coarsen()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00618">refine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// store the elems to be refined until later</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// so we don&#39;t mess with the _elem_id_map while we</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// iterate over it</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    std::vector&lt;std::pair&lt;const libMesh::Elem*,libMesh::Elem*&gt; &gt; elems_to_refine;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// same with elems to coarsen</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// store the main_mesh elem</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    std::vector&lt;const libMesh::Elem*&gt; elems_to_coarsen;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// iterate over all main elems along the rayfire and look for</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// refinement: INACTIVE parent with JUST_REFINED children</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// coarsening: JUST_COARSENED parent</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    std::map&lt;libMesh::dof_id_type,libMesh::dof_id_type&gt;::iterator it = <a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a>.begin();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">for</span>(; it != <a class="code" href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">_elem_id_map</a>.end(); it++)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keyword">const</span> libMesh::Elem* main_elem = mesh_base.elem_ptr(it-&gt;first);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        libmesh_assert(main_elem);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">if</span> (main_elem-&gt;parent())</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">if</span> (main_elem-&gt;parent()-&gt;refinement_flag() == libMesh::Elem::RefinementState::JUST_COARSENED)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;              elems_to_coarsen.push_back(main_elem);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        libMesh::Elem::RefinementState state = main_elem-&gt;refinement_flag();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (state == libMesh::Elem::RefinementState::INACTIVE)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">if</span> (main_elem-&gt;has_children())</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;              <span class="keywordflow">if</span> (main_elem-&gt;child_ptr(0)-&gt;refinement_flag() == libMesh::Elem::RefinementState::JUST_REFINED)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                elems_to_refine.push_back(std::pair&lt;const libMesh::Elem*, libMesh::Elem*&gt;(main_elem,<a class="code" href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">_mesh</a>-&gt;elem_ptr(it-&gt;second)));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;          }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// refine the elements that need it</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;elems_to_refine.size(); i++)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a38be0fb7a492ad0005ef4fabc52baaa6">refine</a>(elems_to_refine[i].first, elems_to_refine[i].second);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// coarsen the elements that need it</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;elems_to_coarsen.size(); i++)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      this-&gt;<a class="code" href="classGRINS_1_1RayfireMesh.html#a91d1c21e91df24fa119934047ca7e58b">coarsen</a>(elems_to_coarsen[i]);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a91d1c21e91df24fa119934047ca7e58b"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a91d1c21e91df24fa119934047ca7e58b">GRINS::RayfireMesh::coarsen</a></div><div class="ttdeci">void coarsen(const libMesh::Elem *rayfire_elem)</div><div class="ttdoc">Coarsening of a rayfire element whose main mesh counterpart was coarsened. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00731">rayfire_mesh.C:731</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a38be0fb7a492ad0005ef4fabc52baaa6"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a38be0fb7a492ad0005ef4fabc52baaa6">GRINS::RayfireMesh::refine</a></div><div class="ttdeci">void refine(const libMesh::Elem *main_elem, libMesh::Elem *rayfire_elem)</div><div class="ttdoc">Refinement of a rayfire element whose main mesh counterpart was refined. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8C_source.html#l00618">rayfire_mesh.C:618</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_af2c3dd53b7aeb5fc90accac7cc2f4a5f"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#af2c3dd53b7aeb5fc90accac7cc2f4a5f">GRINS::RayfireMesh::_mesh</a></div><div class="ttdeci">libMesh::UniquePtr&lt; libMesh::Mesh &gt; _mesh</div><div class="ttdoc">Internal 1D mesh of EDGE2 elements. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00148">rayfire_mesh.h:148</a></div></div>
<div class="ttc" id="classGRINS_1_1RayfireMesh_html_a4444026efd745db379c306522eb1abae"><div class="ttname"><a href="classGRINS_1_1RayfireMesh.html#a4444026efd745db379c306522eb1abae">GRINS::RayfireMesh::_elem_id_map</a></div><div class="ttdeci">std::map&lt; libMesh::dof_id_type, libMesh::dof_id_type &gt; _elem_id_map</div><div class="ttdoc">Map of main mesh elem_id to rayfire mesh elem_id. </div><div class="ttdef"><b>Definition:</b> <a href="rayfire__mesh_8h_source.html#l00151">rayfire_mesh.h:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a66e1db520895502349af00fa70391ac3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool GRINS::RayfireMesh::validate_edge </td>
          <td>(</td>
          <td class="paramtype">const libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>start_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const libMesh::Point &amp;&#160;</td>
          <td class="paramname"><em>end_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const libMesh::Elem *&#160;</td>
          <td class="paramname"><em>side_elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const libMesh::Elem *&#160;</td>
          <td class="paramname"><em>neighbor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ensures the rayfire doesn't wander into the middle of an elem. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8C_source.html#l00392">392</a> of file <a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00432">get_correct_neighbor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">bool</span> is_valid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keyword">const</span> libMesh::Node * node0 = side_elem-&gt;node_ptr(0);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keyword">const</span> libMesh::Node * node1 = side_elem-&gt;node_ptr(1);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> side = libMesh::invalid_uint;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s=0; s&lt;neighbor-&gt;n_sides(); s++)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        libMesh::UniquePtr&lt;const libMesh::Elem&gt; side_elem = neighbor-&gt;build_side_ptr(s);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">if</span> ( (side_elem-&gt;contains_point(*node0)) &amp;&amp; (side_elem-&gt;contains_point(*node1)) )</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            side = s;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span> ( side != libMesh::invalid_uint )</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        libMesh::UniquePtr&lt;const libMesh::Elem&gt; edge_elem = neighbor-&gt;build_side_ptr(side);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordtype">bool</span> start_point_on_edge = edge_elem-&gt;contains_point(start_point);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordtype">bool</span> end_point_on_edge = edge_elem-&gt;contains_point(end_point);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">if</span> ( end_point_on_edge &amp;&amp; start_point_on_edge )</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordtype">bool</span> l_to_r = ( start_point.absolute_fuzzy_equals(*(edge_elem-&gt;node_ptr(0))) ) &amp;&amp; ( end_point.absolute_fuzzy_equals(*(edge_elem-&gt;node_ptr(1))) );</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keywordtype">bool</span> r_to_l = ( end_point.absolute_fuzzy_equals(*(edge_elem-&gt;node_ptr(0))) )   &amp;&amp; ( start_point.absolute_fuzzy_equals(*(edge_elem-&gt;node_ptr(1))) );</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            is_valid &amp;= ( l_to_r || r_to_l );</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">return</span> is_valid;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a21ac01d53d82a291dbd0d9219a4435fe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int GRINS::RayfireMesh::_dim</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dimension of the main mesh. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8h_source.html#l00136">136</a> of file <a class="el" href="rayfire__mesh_8h_source.html">rayfire_mesh.h</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00104">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a4444026efd745db379c306522eb1abae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;libMesh::dof_id_type,libMesh::dof_id_type&gt; GRINS::RayfireMesh::_elem_id_map</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Map of main mesh elem_id to rayfire mesh elem_id. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8h_source.html#l00151">151</a> of file <a class="el" href="rayfire__mesh_8h_source.html">rayfire_mesh.h</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00731">coarsen()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00187">elem_ids_in_rayfire()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00308">get_rayfire_elem()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00104">init()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00092">RayfireMesh()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00618">refine()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00198">reinit()</a>.</p>

</div>
</div>
<a class="anchor" id="af2c3dd53b7aeb5fc90accac7cc2f4a5f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::UniquePtr&lt;libMesh::Mesh&gt; GRINS::RayfireMesh::_mesh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal 1D mesh of EDGE2 elements. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8h_source.html#l00148">148</a> of file <a class="el" href="rayfire__mesh_8h_source.html">rayfire_mesh.h</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00731">coarsen()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00187">elem_ids_in_rayfire()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00308">get_rayfire_elem()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00104">init()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00092">RayfireMesh()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00618">refine()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00198">reinit()</a>.</p>

</div>
</div>
<a class="anchor" id="ab8d4f4fceea9148cd24697418455ca2d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::Point GRINS::RayfireMesh::_origin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Origin point. </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8h_source.html#l00139">139</a> of file <a class="el" href="rayfire__mesh_8h_source.html">rayfire_mesh.h</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00247">check_origin_on_boundary()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00731">coarsen()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00275">get_start_elem()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00104">init()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00061">RayfireMesh()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00618">refine()</a>.</p>

</div>
</div>
<a class="anchor" id="a55348114d2a7c62c74ba9d9d8ee5e289"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::Real GRINS::RayfireMesh::_phi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rayfire Spherical azimuthal angle (in radians) </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8h_source.html#l00145">145</a> of file <a class="el" href="rayfire__mesh_8h_source.html">rayfire_mesh.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3496824565e791d09a9b5e583e6634a9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::Real GRINS::RayfireMesh::_theta</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rayfire Spherical polar angle (in radians) </p>

<p>Definition at line <a class="el" href="rayfire__mesh_8h_source.html#l00142">142</a> of file <a class="el" href="rayfire__mesh_8h_source.html">rayfire_mesh.h</a>.</p>

<p>Referenced by <a class="el" href="rayfire__mesh_8C_source.html#l00541">newton_solve_intersection()</a>, <a class="el" href="rayfire__mesh_8C_source.html#l00372">rayfire_in_elem()</a>, and <a class="el" href="rayfire__mesh_8C_source.html#l00051">RayfireMesh()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/qoi/include/grins/<a class="el" href="rayfire__mesh_8h_source.html">rayfire_mesh.h</a></li>
<li>src/qoi/src/<a class="el" href="rayfire__mesh_8C_source.html">rayfire_mesh.C</a></li>
</ul>
</div><!-- contents -->
<hr size="1"/><address style="text-align: right;"><small>
Generated on Tue Dec 19 2017 12:47:32 for GRINS-0.8.0
by&nbsp;<a href="http://www.doxygen.org/index.html">
<em>doxygen</em></a>
1.8.9.1</small></address>
</body>
</html>
